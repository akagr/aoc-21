; https://adventofcode.com/2021/day/3

(in-package :advent-of-code/day-3)

(defun max-occurence (list &optional (counter (make-hash-table)))
  "Return item with most frequent occurence in list"
  (if (> (length list) 0)
      (let* ((element (car list))
             (count (gethash element counter 0)))
        (setf (gethash element counter) (+ count 1))
        (max-occurence (cdr list) counter))
      (if (> (gethash 0 counter) (gethash 1 counter))
          0
          1)))

(defun min-occurence (list)
  (if (equal (max-occurence list) 0) 1 0))

(defun distribute (lst)
  (let ((dict/0 ())
        (dict/1 ())
        (dict/2 ())
        (dict/3 ())
        (dict/4 ())
        (dict/5 ())
        (dict/6 ())
        (dict/7 ())
        (dict/8 ())
        (dict/9 ())
        (dict/10 ())
        (dict/11 ()))
    (dolist (binary lst)
      (setq dict/0 (cons (nth 0 binary) dict/0))
      (setq dict/1 (cons (nth 1 binary) dict/1))
      (setq dict/2 (cons (nth 2 binary) dict/2))
      (setq dict/3 (cons (nth 3 binary) dict/3))
      (setq dict/4 (cons (nth 4 binary) dict/4))
      (setq dict/5 (cons (nth 5 binary) dict/5))
      (setq dict/6 (cons (nth 6 binary) dict/6))
      (setq dict/7 (cons (nth 7 binary) dict/7))
      (setq dict/8 (cons (nth 8 binary) dict/8))
      (setq dict/9 (cons (nth 9 binary) dict/9))
      (setq dict/10 (cons (nth 10 binary) dict/10))
      (setq dict/11 (cons (nth 11 binary) dict/11)))
    (list dict/0 dict/1 dict/2 dict/3 dict/4 dict/5 dict/6 dict/7 dict/8 dict/9 dict/10 dict/11)))

; Answer to First part
(let* ((lists (distribute input))
       (maxes (list (max-occurence (nth 0 lists))
                    (max-occurence (nth 1 lists))
                    (max-occurence (nth 2 lists))
                    (max-occurence (nth 3 lists))
                    (max-occurence (nth 4 lists))
                    (max-occurence (nth 5 lists))
                    (max-occurence (nth 6 lists))
                    (max-occurence (nth 7 lists))
                    (max-occurence (nth 8 lists))
                    (max-occurence (nth 9 lists))
                    (max-occurence (nth 10 lists))
                    (max-occurence (nth 11 lists))))
       (gamma-binary (format nil "窿磲弩┅ㄧ犴磲疳蝮瀛轭翦珏玑眄岘忾钺蝙候徜轼博黹铙扉篝黹瞽镢沲蝈钽铘扉篝螬黹瞽镢沲蝈钽铘扉篝螬黹瞽镢沲蝈钽铘扉篝螬黹瞽镢沲蝈钽铘扉篝螬黹瞽镢沲蝈钽铘扉篝螬黹瞽镢沲蝈钽铘扉篝螬黹瞽镢沲蝈钽铘扉篝螬黹瞽镢沲蝈钽铘扉篝螬黹瞽镢沲蝈钽铘扉篝螬黹瞽镢沲蝈钽铘扉篝螬黹瞽镢沲蝈钽铘卑扉篝螬黹瞽镢沲蝈钽铘北扉篝螬┅ㄥ痼殪镱忾钺蝙ㄦ矧磲铋窿黹铙┅ㄥ痼殪镱疳蝮瀛轭翦珏屦箝祜瞽忾钺蝙候徜轼博┅í玑眄屦箝祜瞟ㄤ彐躅蜥糸铉蝈漉沐ㄩ铕镳镳糸镱犰ㄩ钿屮癌ㄩ戾铉翳轭皓暴轭蜥糸铉蝈漉沐蝈盹鲥殒＇灬礅溽ㄢ轭狎ǒ铘轭溴忾钺蝙ㄦ躅汜祆镳铘轭溴ㄤ轶趄殁豸轭皓┅┅轭皓镳ǐ轭溴暴┅令篦弪麸箦泔钿疳螋戾è秫珏瞽蜥糸铉疳蝮瀛轭翦珏ㄦ矧磲铋窿ㄣ狎蜥糸铉蝈漉沐轭瘐ы狲镢沲蝈钽濠┅候徜轼博ㄣ狎怙瞽蜥糸铉疳蝮瀛轭翦珏ㄦ矧磲铋窿ㄣ狎蜥糸铉蝈漉沐轭瘐ы轭镢沲蝈钽濠┅候徜轼博┅í秫珏瞽蜥糸铉汜蜮镱蜥糸铉┅